Traceback (most recent call last):
  File "/home/runner/.local/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/runner/.local/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/.local/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
assert torch.autograd.gradcheck(IIR.apply, (test_signal_torch_params[:1000], a_torch_params))
assert torch.autograd.gradgradcheck(IIR.apply, (test_signal_torch_params[:1000], a_torch_params))
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mGradcheckError[0m                            Traceback (most recent call last)
Cell [0;32mIn[17], line 2[0m
[1;32m      1[0m [38;5;28;01massert[39;00m torch[38;5;241m.[39mautograd[38;5;241m.[39mgradcheck(IIR[38;5;241m.[39mapply, (test_signal_torch_params[:[38;5;241m1000[39m], a_torch_params))
[0;32m----> 2[0m [38;5;28;01massert[39;00m [43mtorch[49m[38;5;241;43m.[39;49m[43mautograd[49m[38;5;241;43m.[39;49m[43mgradgradcheck[49m[43m([49m[43mIIR[49m[38;5;241;43m.[39;49m[43mapply[49m[43m,[49m[43m [49m[43m([49m[43mtest_signal_torch_params[49m[43m[[49m[43m:[49m[38;5;241;43m1000[39;49m[43m][49m[43m,[49m[43m [49m[43ma_torch_params[49m[43m)[49m[43m)[49m

File [0;32m~/.local/lib/python3.10/site-packages/torch/autograd/gradcheck.py:2253[0m, in [0;36mgradgradcheck[0;34m(func, inputs, grad_outputs, eps, atol, rtol, gen_non_contig_grad_outputs, raise_exception, nondet_tol, check_undefined_grad, check_grad_dtypes, check_batched_grad, check_fwd_over_rev, check_rev_over_rev, fast_mode, masked)[0m
[1;32m   2250[0m     grad_inputs [38;5;241m=[39m [38;5;28mtuple[39m(g [38;5;28;01mfor[39;00m g [38;5;129;01min[39;00m grad_inputs [38;5;28;01mif[39;00m g [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m)
[1;32m   2251[0m     [38;5;28;01mreturn[39;00m grad_inputs
[0;32m-> 2253[0m [38;5;28;01mreturn[39;00m [43mgradcheck[49m[43m([49m
[1;32m   2254[0m [43m    [49m[43mnew_func[49m[43m,[49m
[1;32m   2255[0m [43m    [49m[43mtupled_inputs[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[43mtupled_grad_outputs[49m[43m,[49m
[1;32m   2256[0m [43m    [49m[43meps[49m[38;5;241;43m=[39;49m[43meps[49m[43m,[49m
[1;32m   2257[0m [43m    [49m[43matol[49m[38;5;241;43m=[39;49m[43matol[49m[43m,[49m
[1;32m   2258[0m [43m    [49m[43mrtol[49m[38;5;241;43m=[39;49m[43mrtol[49m[43m,[49m
[1;32m   2259[0m [43m    [49m[43mraise_exception[49m[38;5;241;43m=[39;49m[43mraise_exception[49m[43m,[49m
[1;32m   2260[0m [43m    [49m[43mnondet_tol[49m[38;5;241;43m=[39;49m[43mnondet_tol[49m[43m,[49m
[1;32m   2261[0m [43m    [49m[43mcheck_undefined_grad[49m[38;5;241;43m=[39;49m[43mcheck_undefined_grad[49m[43m,[49m
[1;32m   2262[0m [43m    [49m[43mcheck_grad_dtypes[49m[38;5;241;43m=[39;49m[43mcheck_grad_dtypes[49m[43m,[49m
[1;32m   2263[0m [43m    [49m[43mcheck_batched_grad[49m[38;5;241;43m=[39;49m[43mcheck_batched_grad[49m[43m,[49m
[1;32m   2264[0m [43m    [49m[43mfast_mode[49m[38;5;241;43m=[39;49m[43mfast_mode[49m[43m,[49m
[1;32m   2265[0m [43m    [49m[43mcheck_forward_ad[49m[38;5;241;43m=[39;49m[43mcheck_fwd_over_rev[49m[43m,[49m
[1;32m   2266[0m [43m    [49m[43mcheck_backward_ad[49m[38;5;241;43m=[39;49m[43mcheck_rev_over_rev[49m[43m,[49m
[1;32m   2267[0m [43m    [49m[43mmasked[49m[38;5;241;43m=[39;49m[43mmasked[49m[43m,[49m
[1;32m   2268[0m [43m[49m[43m)[49m

File [0;32m~/.local/lib/python3.10/site-packages/torch/autograd/gradcheck.py:2051[0m, in [0;36mgradcheck[0;34m(func, inputs, eps, atol, rtol, raise_exception, check_sparse_nnz, nondet_tol, check_undefined_grad, check_grad_dtypes, check_batched_grad, check_batched_forward_grad, check_forward_ad, check_backward_ad, fast_mode, masked)[0m
[1;32m   2049[0m         [38;5;28;01mreturn[39;00m [38;5;28;01mFalse[39;00m
[1;32m   2050[0m [38;5;28;01melse[39;00m:
[0;32m-> 2051[0m     [38;5;28;01mreturn[39;00m [43m_gradcheck_helper[49m[43m([49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43margs[49m[43m)[49m

File [0;32m~/.local/lib/python3.10/site-packages/torch/autograd/gradcheck.py:2080[0m, in [0;36m_gradcheck_helper[0;34m(func, inputs, eps, atol, rtol, nondet_tol, check_undefined_grad, check_grad_dtypes, check_batched_grad, check_batched_forward_grad, check_forward_ad, check_backward_ad, fast_mode, masked)[0m
[1;32m   2075[0m _check_outputs(outputs)
[1;32m   2077[0m gradcheck_fn [38;5;241m=[39m functools[38;5;241m.[39mpartial(
[1;32m   2078[0m     _fast_gradcheck [38;5;28;01mif[39;00m fast_mode [38;5;28;01melse[39;00m _slow_gradcheck, masked[38;5;241m=[39mmasked
[1;32m   2079[0m )
[0;32m-> 2080[0m [43m_gradcheck_real_imag[49m[43m([49m
[1;32m   2081[0m [43m    [49m[43mgradcheck_fn[49m[43m,[49m
[1;32m   2082[0m [43m    [49m[43mfunc[49m[43m,[49m
[1;32m   2083[0m [43m    [49m[43mfunc_out[49m[43m,[49m
[1;32m   2084[0m [43m    [49m[43mtupled_inputs[49m[43m,[49m
[1;32m   2085[0m [43m    [49m[43moutputs[49m[43m,[49m
[1;32m   2086[0m [43m    [49m[43meps[49m[43m,[49m
[1;32m   2087[0m [43m    [49m[43mrtol[49m[43m,[49m
[1;32m   2088[0m [43m    [49m[43matol[49m[43m,[49m
[1;32m   2089[0m [43m    [49m[43mcheck_grad_dtypes[49m[43m,[49m
[1;32m   2090[0m [43m    [49m[43mcheck_forward_ad[49m[38;5;241;43m=[39;49m[43mcheck_forward_ad[49m[43m,[49m
[1;32m   2091[0m [43m    [49m[43mcheck_backward_ad[49m[38;5;241;43m=[39;49m[43mcheck_backward_ad[49m[43m,[49m
[1;32m   2092[0m [43m    [49m[43mnondet_tol[49m[38;5;241;43m=[39;49m[43mnondet_tol[49m[43m,[49m
[1;32m   2093[0m [43m    [49m[43mcheck_undefined_grad[49m[38;5;241;43m=[39;49m[43mcheck_undefined_grad[49m[43m,[49m
[1;32m   2094[0m [43m[49m[43m)[49m
[1;32m   2096[0m [38;5;28;01mif[39;00m check_batched_forward_grad:
[1;32m   2097[0m     _test_batched_grad_forward_ad(func, tupled_inputs)

File [0;32m~/.local/lib/python3.10/site-packages/torch/autograd/gradcheck.py:1482[0m, in [0;36m_gradcheck_real_imag[0;34m(gradcheck_fn, func, func_out, tupled_inputs, outputs, eps, rtol, atol, check_grad_dtypes, check_forward_ad, check_backward_ad, nondet_tol, check_undefined_grad)[0m
[1;32m   1469[0m         gradcheck_fn(
[1;32m   1470[0m             real_fn,
[1;32m   1471[0m             real_func_out,
[0;32m   (...)[0m
[1;32m   1479[0m             complex_indices[38;5;241m=[39mcomplex_out_indices,
[1;32m   1480[0m         )
[1;32m   1481[0m     [38;5;28;01melse[39;00m:
[0;32m-> 1482[0m         [43mgradcheck_fn[49m[43m([49m
[1;32m   1483[0m [43m            [49m[43mfunc[49m[43m,[49m
[1;32m   1484[0m [43m            [49m[43mfunc_out[49m[43m,[49m
[1;32m   1485[0m [43m            [49m[43mtupled_inputs[49m[43m,[49m
[1;32m   1486[0m [43m            [49m[43moutputs[49m[43m,[49m
[1;32m   1487[0m [43m            [49m[43meps[49m[43m,[49m
[1;32m   1488[0m [43m            [49m[43mrtol[49m[43m,[49m
[1;32m   1489[0m [43m            [49m[43matol[49m[43m,[49m
[1;32m   1490[0m [43m            [49m[43mcheck_grad_dtypes[49m[43m,[49m
[1;32m   1491[0m [43m            [49m[43mnondet_tol[49m[43m,[49m
[1;32m   1492[0m [43m        [49m[43m)[49m
[1;32m   1494[0m [38;5;28;01mif[39;00m check_forward_ad:
[1;32m   1495[0m     complex_inp_indices [38;5;241m=[39m [
[1;32m   1496[0m         i
[1;32m   1497[0m         [38;5;28;01mfor[39;00m i, inp [38;5;129;01min[39;00m [38;5;28menumerate[39m(tupled_inputs)
[1;32m   1498[0m         [38;5;28;01mif[39;00m is_tensor_like(inp) [38;5;129;01mand[39;00m inp[38;5;241m.[39mis_complex()
[1;32m   1499[0m     ]

File [0;32m~/.local/lib/python3.10/site-packages/torch/autograd/gradcheck.py:1623[0m, in [0;36m_slow_gradcheck[0;34m(func, func_out, tupled_inputs, outputs, eps, rtol, atol, check_grad_dtypes, nondet_tol, use_forward_ad, complex_indices, test_imag, masked)[0m
[1;32m   1621[0m         [38;5;28;01mfor[39;00m j, (a, n) [38;5;129;01min[39;00m [38;5;28menumerate[39m([38;5;28mzip[39m(analytical, numerical[i])):
[1;32m   1622[0m             [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m _allclose_with_type_promotion(a, n[38;5;241m.[39mto(a[38;5;241m.[39mdevice), rtol, atol):
[0;32m-> 1623[0m                 [38;5;28;01mraise[39;00m GradcheckError(
[1;32m   1624[0m                     _get_notallclose_msg(a, n, i, j, complex_indices, test_imag)
[1;32m   1625[0m                 )
[1;32m   1627[0m [38;5;28;01mreturn[39;00m [38;5;28;01mTrue[39;00m

[0;31mGradcheckError[0m: Jacobian mismatch for output 1 with respect to input 2,
numerical:tensor([[ 0.0000e+00,  0.0000e+00],
        [-3.7835e-04,  0.0000e+00],
        [-2.2119e-03, -4.0745e-04],
        ...,
        [ 2.3772e+03,  2.4922e+03],
        [ 2.2619e+03,  2.3772e+03],
        [ 2.1460e+03,  2.2619e+03]], dtype=torch.float64)
analytical:tensor([[ 0.0000e+00,  0.0000e+00],
        [-3.9270e-04,  0.0000e+00],
        [-2.2114e-03, -3.9270e-04],
        ...,
        [ 2.3772e+03,  2.4922e+03],
        [ 2.2619e+03,  2.3772e+03],
        [ 2.1460e+03,  2.2619e+03]], dtype=torch.float64)


